# Copyright 2025 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
################################################################################

homepage: "https://github.com/google-gemini/gemini-cli"
language: go  # Primary language - Go fuzzing with native Go fuzzing support
primary_contact: "reconsumeralization@gmail.com"
auto_ccs:
  - "security@google.com"
vendor_ccs:
  - "reconsumeralization@gmail.com"
main_repo: "https://github.com/google-gemini/gemini-cli.git"

# OSS-Fuzz Integration for Gemini CLI
# Comprehensive fuzzing coverage for critical input parsing and security validation
file_github_issue: true

# Build integration settings
build_integration:
  build_script: build.sh
  dockerfile: Dockerfile

# Sanitizers for Go fuzzing
sanitizers:
  - address
  - undefined

# Fuzzing engines
fuzzing_engines:
  - libfuzzer

# Supported architectures
architectures:
  - x86_64

# Coverage configuration
coverage_extra_args: |
  --include=/src/gemini-cli/src/**/*.js
  --include=/src/gemini-cli/src/**/*.ts
  --include=/src/gemini-cli/gofuzz/**/*.go
  --exclude=/src/gemini-cli/**/test*.js
  --exclude=/src/gemini-cli/**/spec*.js
  --exclude=/src/gemini-cli/**/node_modules/**
  --exclude=/src/gemini-cli/**/build_cache/**
  --exclude=/src/gemini-cli/**/dist/**
  --exclude=/src/gemini-cli/gofuzz/fuzz/**
  --gcov-options="--branch-counts --branch-probabilities"
  --keep-going

# Fuzz introspector configuration
fuzz_introspector: |
  analyze: |
    # Core fuzz targets for Gemini CLI security
    - gofuzz/fuzz/fuzz_config_parser.go
    - gofuzz/fuzz/fuzz_cli_parser.go
    - gofuzz/fuzz/fuzz_mcp_request.go
    - gofuzz/fuzz/fuzz_mcp_response.go
    - gofuzz/fuzz/fuzz_oauth_token_request.go
    - gofuzz/fuzz/fuzz_oauth_token_response.go
    - gofuzz/fuzz/fuzz_file_system_operations.go
    - gofuzz/fuzz/fuzz_url_parser.go
    - gofuzz/fuzz/fuzz_crypto_operations.go
    - gofuzz/fuzz/fuzz_environment_parser.go
    - gofuzz/fuzz/fuzz_input_sanitizer.go
    - gofuzz/fuzz/fuzz_slash_commands.go
    - gofuzz/fuzz/fuzz_context_file_parser.go
    - gofuzz/fuzz/fuzz_path_validation.go
    - gofuzz/fuzz/fuzz_shell_validation.go
    - gofuzz/fuzz/fuzz_symlink_validation.go
    - gofuzz/fuzz/fuzz_tool_invocation.go

  # Performance optimization
  performance:
    target_executions_per_second: 1000
    max_memory_mb: 2048
    timeout_seconds: 30

# Labels for categorization
labels:
  - cli
  - security
  - json
  - ai
  - llm
  - go
  - fuzzing
  - input-validation
  - oauth
  - mcp
